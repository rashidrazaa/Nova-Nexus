<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>College Events Portal</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://ai-public.creatie.ai/gen_page/tailwind-custom.css" rel="stylesheet">
    <script
        src="https://cdn.tailwindcss.com/3.4.5?plugins=forms@0.5.7,typography@0.5.13,aspect-ratio@0.4.2,container-queries@0.1.1"></script>
    <script src="https://ai-public.creatie.ai/gen_page/tailwind-config.min.js" data-color="#000000"
        data-border-radius="small"></script>
</head>

<body class="bg-gray-50 min-h-screen flex flex-col">
    <header class="bg-white shadow-sm">
        <nav class="max-w-8xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex">
                    <div class="flex-shrink-0 flex items-center"> <img class="h-8 w-auto"
                            src="NN logo.svg" alt="Logo">
                    </div>
                    <div class="hidden sm:ml-6 sm:flex sm:space-x-8">
                        <a href="#"
                            class="border-custom text-custom inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium">Events</a>
                        <a href="#"
                            class="border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium">Schedule</a>
                        <a href="#"
                            class="border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium">Updates</a>
                    </div>
                </div>

                <div class="flex items-center">
                    <button
                        class="!rounded-button bg-custom text-white px-4 py-2 text-sm font-medium hover:bg-custom/90">Logout</button>
                </div>
            </div>
        </nav>
    </header>

    <main class="flex-grow">
        <div class="max-w-8xl mx-auto px-4 sm:px-6 lg:px-8 py-8">

            <h1 class="text-2xl font-bold text-gray-900">Registration Management Dashboard</h1><br>
            <div class="mb-8">
                <div class="relative">
                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"> <i
                            class="fas fa-search text-gray-400"></i>
                    </div>
                    <input type="text"
                        class="block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-custom focus:border-custom sm:text-sm"
                        placeholder="Search events...">
                </div>
            </div>

            <div class="flex space-x-4 mb-8">
                <button id="filterAll" class="!rounded-button bg-custom px-4 py-2 text-sm font-medium text-white">All Events</button>
                <button id="filterInter" class="!rounded-button bg-white border border-gray-300 px-4 py-2 text-sm font-medium text-gray-700">Inter-College</button>
                <button id="filterIntra" class="!rounded-button bg-white border border-gray-300 px-4 py-2 text-sm font-medium text-gray-700">Intra-College</button>
            </div>

            <div class="grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3">
                <div class="bg-white overflow-hidden shadow rounded-lg">
                    <div class="p-6">
                        <div class="flex items-center">
                            <div class="flex-shrink-0"> <i class="fas fa-trophy text-custom text-2xl"></i>
                            </div>
                            <div class="ml-4">
                                <h3 class="text-lg font-medium text-gray-900">Annual Tech Fest</h3>
                                <p class="text-sm text-gray-500">Inter-College Event</p>
                            </div>
                        </div>
                        <div class="mt-4">
                            <div class="flex items-center text-sm text-gray-500">
                                <i class="far fa-calendar mr-2"></i>
                                <span>March 15-17, 2024</span>
                            </div>
                            <div class="flex items-center mt-2 text-sm text-gray-500"> <i class="fas fa-users mr-2"></i>
                                <span>12 Colleges Participating</span>
                            </div>
                        </div>
                        <div class="mt-4">
                            <button
                                class="!rounded-button w-full bg-custom px-4 py-2 text-sm font-medium text-white hover:bg-custom/90">Register
                                Now</button>
                        </div>
                    </div>
                </div>

                <div class="bg-white overflow-hidden shadow rounded-lg">
                    <div class="p-6">
                        <div class="flex items-center">
                            <div class="flex-shrink-0"> <i class="fas fa-music text-custom text-2xl"></i>
                            </div>
                            <div class="ml-4">
                                <h3 class="text-lg font-medium text-gray-900">Cultural Night</h3>
                                <p class="text-sm text-gray-500">Intra-College Event</p>
                            </div>
                        </div>
                        <div class="mt-4">
                            <div class="flex items-center text-sm text-gray-500">
                                <i class="far fa-calendar mr-2"></i>
                                <span>March 20, 2024</span>
                            </div>
                            <div class="flex items-center mt-2 text-sm text-gray-500"> <i
                                    class="fas fa-user-group mr-2"></i>
                                <span>200+ Participants</span>
                            </div>
                        </div>
                        <div class="mt-4">
                            <button
                                class="!rounded-button w-full bg-custom px-4 py-2 text-sm font-medium text-white hover:bg-custom/90">Register
                                Now</button>
                        </div>
                    </div>
                </div>

                <div class="bg-white overflow-hidden shadow rounded-lg">
                    <div class="p-6">
                        <div class="flex items-center">
                            <div class="flex-shrink-0"> <i class="fas fa-code text-custom text-2xl"></i>
                            </div>
                            <div class="ml-4">
                                <h3 class="text-lg font-medium text-gray-900">Hackathon 2024</h3>
                                <p class="text-sm text-gray-500">Inter-College Event</p>
                            </div>
                        </div>
                        <div class="mt-4">
                            <div class="flex items-center text-sm text-gray-500">
                                <i class="far fa-calendar mr-2"></i>
                                <span>April 5-6, 2024</span>
                            </div>
                            <div class="flex items-center mt-2 text-sm text-gray-500"> <i class="fas fa-users mr-2"></i>
                                <span>8 Colleges Participating</span>
                            </div>
                        </div>
                        <div class="mt-4">
                            <button
                                class="!rounded-button w-full bg-custom px-4 py-2 text-sm font-medium text-white hover:bg-custom/90">Register
                                Now</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="mt-8 bg-white shadow rounded-lg overflow-hidden">
                <div class="px-4 py-5 sm:px-6">
                    <h3 class="text-lg font-medium text-gray-900">Live Updates</h3>
                </div>
                <div class="border-t border-gray-200">
                    <div class="px-4 py-5 sm:p-6 space-y-4">
                        <div class="flex items-start">
                            <div class="flex-shrink-0">
                                <span class="inline-flex items-center justify-center h-8 w-8 rounded-full bg-green-100">
                                    <i class="fas fa-check text-green-600"></i>
                                </span>
                            </div>
                            <div class="ml-3">
                                <h4 class="text-sm font-medium text-gray-900">Tech Fest Registration Open</h4>
                                <p class="mt-1 text-sm text-gray-500">Registration for Annual Tech Fest 2024 is now
                                    open. Early bird discounts available!</p>
                            </div>
                        </div>
                        <div class="flex items-start">
                            <div class="flex-shrink-0"> <span
                                    class="inline-flex items-center justify-center h-8 w-8 rounded-full bg-blue-100">
                                    <i class="fas fa-info text-blue-600"></i>
                                </span>
                            </div>
                            <div class="ml-3">
                                <h4 class="text-sm font-medium text-gray-900">Cultural Night Schedule Update</h4>
                                <p class="mt-1 text-sm text-gray-500">Performance schedule for Cultural Night has been
                                    finalized. Check your dashboard for details.</p>
                            </div>
                        </div>
                        <div class="flex items-start">
                            <div class="flex-shrink-0"> <span
                                    class="inline-flex items-center justify-center h-8 w-8 rounded-full bg-yellow-100">
                                    <i class="fas fa-exclamation text-yellow-600"></i>
                                </span>
                            </div>
                            <div class="ml-3">
                                <h4 class="text-sm font-medium text-gray-900">Hackathon Theme Announcement</h4>
                                <p class="mt-1 text-sm text-gray-500">Theme for Hackathon 2024 will be announced next
                                    week. Stay tuned!</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
    <footer class="bg-white">
        <div class="max-w-8xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <div>
                    <img class="h-8 w-auto" src="NN logo.svg" alt="Logo">
                    <p class="mt-4 text-sm text-gray-500">Making college events management simple and efficient.</p>
                </div>
                <div>
                    <h3 class="text-sm font-semibold text-gray-400 uppercase tracking-wider">Quick Links</h3>
                    <ul class="mt-4 space-y-4">
                        <li><a href="#" class="text-base text-gray-500 hover:text-gray-900">Events</a></li>
                        <li><a href="#" class="text-base text-gray-500 hover:text-gray-900">Schedule</a></li>
                        <li><a href="#" class="text-base text-gray-500 hover:text-gray-900">Updates</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-sm font-semibold text-gray-400 uppercase tracking-wider">Support</h3>
                    <ul class="mt-4 space-y-4">
                        <li><a href="#" class="text-base text-gray-500 hover:text-gray-900">Help Center</a></li>
                        <li><a href="#" class="text-base text-gray-500 hover:text-gray-900">Contact Us</a></li>
                        <li><a href="#" class="text-base text-gray-500 hover:text-gray-900">FAQ</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-sm font-semibold text-gray-400 uppercase tracking-wider">Connect</h3>
                    <div class="mt-4 flex space-x-6">
                        <a href="#" class="text-gray-400 hover:text-gray-500"> <i class="fab fa-facebook-f"></i>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-gray-500"> <i class="fab fa-twitter"></i>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-gray-500"> <i class="fab fa-instagram"></i>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-gray-500"> <i class="fab fa-linkedin-in"></i>
                        </a>
                    </div>
                </div>
            </div>
            <div class="mt-8 border-t border-gray-200 pt-8">
                <p class="text-base text-gray-400 text-center">&copy; 2024 College Events Portal. All rights reserved.
                </p>
            </div>
        </div>
    </footer>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        console.log("DOM loaded, fetching events for participant dashboard...");
        const eventsContainer = document.querySelector('.grid');
        console.log("Events container found:", eventsContainer);
        
        const filterAll = document.getElementById('filterAll');
        const filterInter = document.getElementById('filterInter');
        const filterIntra = document.getElementById('filterIntra');

        let allEvents = []; // Store all events fetched from the API

        // Function to filter and display events
        const displayEvents = (filter = 'all') => {
            const filteredEvents = filter === 'all' ? allEvents : allEvents.filter(event => event.type === filter);
            eventsContainer.innerHTML = ''; // Clear existing cards

            if (filteredEvents.length === 0) {
                eventsContainer.innerHTML = '<div class="col-span-3 text-center text-gray-500">No events available.</div>';
                return;
            }

            filteredEvents.forEach(event => {
                // Ensure registeredParticipants is defined
                const registeredParticipants = event.registeredParticipants || [];
                const eventCard = `
                    <div class="bg-white overflow-hidden shadow rounded-lg">
                        <div class="p-6">
                            <div class="flex items-center">
                                <div class="flex-shrink-0">
                                    <i class="fas fa-calendar text-custom text-2xl"></i>
                                </div>
                                <div class="ml-4">
                                    <h3 class="text-lg font-medium text-gray-900">${event.title}</h3>
                                    <p class="text-sm text-gray-500">${event.type} Event</p>
                                </div>
                            </div>
                            <div class="mt-4">
                                <div class="flex items-center text-sm text-gray-500">
                                    <i class="far fa-calendar mr-2"></i>
                                    <span>${new Date(event.date.start).toLocaleDateString()} - ${new Date(event.date.end).toLocaleDateString()}</span>
                                </div>
                                <div class="flex items-center mt-2 text-sm text-gray-500">
                                    <i class="fas fa-location-dot mr-2"></i>
                                    <span>${event.venue}</span>
                                </div>
                                <div class="flex items-center mt-2 text-sm text-gray-500">
                                    <i class="fas fa-users mr-2"></i>
                                    <span>${registeredParticipants.length}/${event.maxParticipants} Participants</span>
                                </div>
                            </div>
                            <div class="mt-4">
                                <a href="/eventRegistration.html?eventId=${event._id}">
                                    <button class="!rounded-button w-full bg-custom px-4 py-2 text-sm font-medium text-white hover:bg-custom/90">
                                        Register Now
                                    </button>
                                </a>
                            </div>
                        </div>
                    </div>
                `;
                eventsContainer.innerHTML += eventCard;
            });
        };

        // Fetch all events
        fetch('/api/events')
            .then(response => {
                console.log("API response status:", response.status);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                return response.json();
            })
            .then(events => {
                console.log("Events received:", events);
                if (!Array.isArray(events)) {
                    throw new Error("Expected an array of events, but got something else");
                }
                allEvents = events; // Store all events
                displayEvents(); // Display all events by default
            })
            .catch(error => {
                console.error('Error fetching events:', error);
                eventsContainer.innerHTML = '<div class="col-span-3 text-center text-red-500">Error loading events. Check console for details.</div>';
            });

        // Add event listeners to filter buttons
        filterAll.addEventListener('click', () => {
            filterAll.classList.add('bg-custom', 'text-white');
            filterAll.classList.remove('bg-white', 'border', 'text-gray-700');
            filterInter.classList.remove('bg-custom', 'text-white');
            filterInter.classList.add('bg-white', 'border', 'text-gray-700');
            filterIntra.classList.remove('bg-custom', 'text-white');
            filterIntra.classList.add('bg-white', 'border', 'text-gray-700');
            displayEvents('all');
        });

        filterInter.addEventListener('click', () => {
            filterInter.classList.add('bg-custom', 'text-white');
            filterInter.classList.remove('bg-white', 'border', 'text-gray-700');
            filterAll.classList.remove('bg-custom', 'text-white');
            filterAll.classList.add('bg-white', 'border', 'text-gray-700');
            filterIntra.classList.remove('bg-custom', 'text-white');
            filterIntra.classList.add('bg-white', 'border', 'text-gray-700');
            displayEvents('inter');
        });

        filterIntra.addEventListener('click', () => {
            filterIntra.classList.add('bg-custom', 'text-white');
            filterIntra.classList.remove('bg-white', 'border', 'text-gray-700');
            filterAll.classList.remove('bg-custom', 'text-white');
            filterAll.classList.add('bg-white', 'border', 'text-gray-700');
            filterInter.classList.remove('bg-custom', 'text-white');
            filterInter.classList.add('bg-white', 'border', 'text-gray-700');
            displayEvents('intra');
        });

        // Add event listener for search input
        const searchInput = document.querySelector('input[placeholder="Search events..."]');
        if (searchInput) {
            searchInput.addEventListener('input', (e) => {
                console.log("Search input:", e.target.value);
                // Add your search logic here
            });
        }

        // Add event listener for the Logout button
        const logoutButton = document.querySelector('button.bg-custom.text-white.px-4.py-2.text-sm.font-medium.hover\\:bg-custom\\/90');
        if (logoutButton) {
            logoutButton.addEventListener('click', () => {
                // Perform logout actions
                console.log("Logout button clicked");
                // Clear any session or authentication tokens
                localStorage.removeItem('authToken'); // Example: Remove token from localStorage
                sessionStorage.removeItem('authToken'); // Example: Remove token from sessionStorage

                // Redirect to the login page
                window.location.href = '/index.html'; // Replace with your login page URL
            });
        }
    });
    </script>
</body>

</html>